<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards - M√©canique des fluides</title>

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #2C75FF, #002FA7);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        overflow-x: hidden;
    }

    .container {
        max-width: 900px;
        width: 100%;
        position: relative;
        z-index: 1;
    }

    .header {
        text-align: center;
        color: white;
        margin-bottom: 25px;
    }

    .header h1 {
        font-size: 2.2em;
        margin-bottom: 8px;
        text-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .header p {
        opacity: 0.95;
    }

    .top-panels {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
        margin-bottom: 18px;
    }

    .panel {
        background: rgba(255,255,255,0.16);
        border: 1px solid rgba(255,255,255,0.18);
        border-radius: 18px;
        padding: 12px 14px;
        color: white;
        backdrop-filter: blur(6px);
        box-shadow: 0 8px 18px rgba(0,0,0,0.15);
    }

    .panel-row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        align-items: center;
    }

    .btn {
        padding: 10px 18px;
        border-radius: 50px;
        font-weight: 700;
        cursor: pointer;
        border: none;
        background: white;
        color: #2C75FF;
        box-shadow: 0 4px 6px rgba(0,0,0,0.12);
        transition: transform 0.2s, opacity 0.2s;
        user-select: none;
    }

    .btn:active {
        transform: scale(0.95);
    }

    .btn.secondary {
        background: rgba(255,255,255,0.92);
        color: #0b2a88;
    }

    .btn.danger {
        background: rgba(255,255,255,0.92);
        color: #b91c1c;
    }

    .btn-know {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
    }

    .btn-dontknow {
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: white;
    }

    .select {
        border: none;
        border-radius: 50px;
        padding: 10px 14px;
        font-weight: 700;
        outline: none;
        cursor: pointer;
        background: white;
        color: #2C75FF;
        box-shadow: 0 4px 6px rgba(0,0,0,0.12);
    }

    .stats {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        font-weight: 700;
    }

    .chip {
        background: rgba(255,255,255,0.22);
        border: 1px solid rgba(255,255,255,0.2);
        padding: 6px 12px;
        border-radius: 999px;
        color: white;
        font-size: 14px;
    }

    /* --- CARTE --- */
    .card-scene {
        perspective: 1000px;
        width: 100%;
        height: 450px;
        cursor: pointer;
    }

    .card {
        width: 100%;
        height: 100%;
        position: relative;
        transition: transform 0.6s cubic-bezier(0.4, 0.2, 0.2, 1);
        transform-style: preserve-3d;
        border-radius: 25px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    }

    .card.is-flipped {
        transform: rotateY(180deg);
    }

    .card-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
        border-radius: 25px;
        padding: 40px;
        background: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .card-face.back {
        transform: rotateY(180deg);
        background: #fdfdfd;
    }

    .card-label {
        position: absolute;
        top: 30px;
        font-size: 13px;
        font-weight: 900;
        padding: 8px 20px;
        border-radius: 20px;
        color: white;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .bg-question {
        background: linear-gradient(135deg, #74D0F1, #0000FF);
    }

    .bg-answer {
        background: linear-gradient(135deg, #10b981, #059669);
    }

    .card-content {
        font-size: 22px;
        line-height: 1.6;
        color: #333;
        width: 100%;
        overflow-y: auto;
        max-height: 80%;
        white-space: pre-line;
    }

    mjx-container {
        font-size: 110% !important;
        outline: none;
    }

    .card-hint {
        position: absolute;
        bottom: 18px;
        font-size: 14px;
        color: #aaa;
        width: 100%;
        text-align: center;
    }

    /* --- BADGE ETAT CARTE --- */
    .status-pill {
        position: absolute;
        top: 30px;
        right: 30px;
        font-size: 12px;
        font-weight: 900;
        padding: 8px 12px;
        border-radius: 999px;
        color: white;
        text-transform: uppercase;
        letter-spacing: 0.7px;
        box-shadow: 0 8px 18px rgba(0,0,0,0.15);
    }

    .status-unknown {
        background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    .status-known {
        background: linear-gradient(135deg, #10b981, #059669);
    }

    .status-unset {
        background: linear-gradient(135deg, #64748b, #475569);
    }

    /* --- NAVIGATION --- */
    .navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 22px;
        padding: 0 10px;
    }

    .nav-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        background: linear-gradient(135deg, #74D0F1, #0000FF);
        color: white;
        font-size: 20px;
        cursor: pointer;
        transition: transform 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .nav-btn:hover {
        transform: scale(1.1);
    }

    .nav-btn:active {
        transform: scale(0.9);
    }

    .counter {
        color: white;
        font-size: 18px;
        font-weight: 700;
        background: rgba(255,255,255,0.2);
        padding: 5px 15px;
        border-radius: 15px;
    }

    .progress-bar {
        margin-top: 20px;
        height: 8px;
        background: rgba(0,0,0,0.2);
        border-radius: 10px;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #74D0F1, #0000FF);
        width: 0%;
        transition: width 0.3s ease-out;
    }

    .keyboard-hint {
        text-align: center;
        color: rgba(255,255,255,0.6);
        font-size: 12px;
        margin-top: 10px;
    }

    /* --- BOUTONS JE SAIS / JE SAIS PAS --- */
    .knowbar {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-top: 18px;
        flex-wrap: wrap;
    }

    @media (max-width: 520px) {
        .card-face { padding: 28px; }
        .card-content { font-size: 19px; }
        .status-pill { top: 20px; right: 20px; }
    }
</style>


</head><script>
  window.MathJax = {
    tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
    },
    svg: { fontCache: 'global' },
    startup: { typeset: false }
  };
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script><body>
    <div class="container">
        <div class="header">
            <h1>M√©canique des fluides/</h1>
            <p>Flashcards + R√©vision intelligente (localStorage)</p>
        </div>

    <div class="top-panels">
        <div class="panel">
            <div class="panel-row">
				    <button class="btn" onclick="window.location.href='index.html'">üè† Accueil</button>
                <button class="btn" onclick="shuffleCards()">üé≤ M√©langer</button>
                <button class="btn secondary" onclick="resetOrder()">‚Ü©Ô∏è Ordre normal</button>
                <button class="btn danger" onclick="resetProgress()">üßπ Reset progr√®s</button>

                <select class="select" id="filterSelect" onchange="applyFilter()">
                    <option value="all">üìö Toutes</option>
                    <option value="review">üü† √Ä revoir</option>
                    <option value="known">üü¢ Ma√Ætris√©es</option>
                </select>
            </div>
        </div>

        <div class="panel">
            <div class="stats" id="statsArea">
                <span class="chip">Chargement...</span>
            </div>
        </div>
    </div>

    <div class="card-scene" onclick="flipCard()">
        <div class="card" id="cardElement">

            <div class="card-face front">
                <div class="card-label bg-question">Question</div>
                <div class="status-pill status-unset" id="statusPill">Non not√©e</div>
                <div class="card-content" id="questionContent"></div>
                <div class="card-hint">Toucher ou Espace pour retourner</div>
            </div>

            <div class="card-face back">
                <div class="card-label bg-answer">R√©ponse</div>
                <div class="card-content" id="answerContent"></div>
            </div>

        </div>
    </div>

    <div class="knowbar">
        <button class="btn btn-dontknow" onclick="markDontKnow(event)">üü† Je sais pas</button>
        <button class="btn btn-know" onclick="markKnow(event)">üü¢ Je sais</button>
    </div>

    <div class="navigation">
        <button class="nav-btn" onclick="previousCard(event)">‚Üê</button>
        <div class="counter">
            <span id="currentCard">1</span> / <span id="totalCards">1</span>
        </div>
        <button class="nav-btn" onclick="nextCard(event)">‚Üí</button>
    </div>

    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <div class="keyboard-hint">
        ‚å®Ô∏è Fl√®ches : naviguer ‚Ä¢ Espace : retourner ‚Ä¢ 1 = Je sais pas ‚Ä¢ 2 = Je sais
    </div>
</div>


<script>


const flashcardsData = [
  {
    id: "MecaFlu_01",
    q: "Quelle est la d√©finition de la pression et son unit√© ?",
    a: "La pression est la force par unit√© de surface : $p = \\frac{dF}{dS}$. Unit√© : Pascal (Pa) ou N/m¬≤. Pression atmosph√©rique : $p_{atm} \\approx 10^5$ Pa = 1 bar"
  },
  {
    id: "MecaFlu_02",
    q: "Quelle est la loi fondamentale de la statique des fluides ?",
    a: "$\\vec{grad}(p) = \\rho \\vec{g}$. En projection verticale (Oz vers le haut) : $\\frac{dp}{dz} = -\\rho g$"
  },
  {
    id: "MecaFlu_03",
    q: "Quelle est la relation de la pression pour un fluide incompressible au repos ?",
    a: "$p(z) = p_0 - \\rho gz$ ou $p_1 + \\rho gz_1 = p_2 + \\rho gz_2$. La pression augmente avec la profondeur."
  },
  {
    id: "MecaFlu_04",
    q: "√ânonc√© du th√©or√®me d'Archim√®de",
    a: "Tout corps immerg√© subit une pouss√©e verticale dirig√©e vers le haut √©gale au poids du fluide d√©plac√© : $\\vec{\\Pi} = -\\rho_{fluide} \\times V_{immerg√©} \\times \\vec{g}$"
  },
  {
    id: "MecaFlu_05",
    q: "Qu'est-ce que le d√©bit volumique et le d√©bit massique ?",
    a: "D√©bit volumique : $Q_v = \\frac{dV}{dt}$ (m¬≥/s). D√©bit massique : $Q_m = \\frac{dm}{dt} = \\rho Q_v$ (kg/s)"
  },
  {
    id: "MecaFlu_06",
    q: "Quelle est l'√©quation de continuit√© pour un fluide incompressible ?",
    a: "$Q_v = S_1 v_1 = S_2 v_2 = $ constante. La vitesse est plus grande l√† o√π la section est plus petite."
  },
  {
    id: "MecaFlu_07",
    q: "√ânonc√© du th√©or√®me de Bernoulli pour un fluide parfait",
    a: "Pour un √©coulement permanent, incompressible, d'un fluide parfait : $p + \\frac{1}{2}\\rho v^2 + \\rho gz = $ constante le long d'une ligne de courant"
  },
  {
    id: "MecaFlu_08",
    q: "Formule de Bernoulli entre deux points 1 et 2",
    a: "$p_1 + \\frac{1}{2}\\rho v_1^2 + \\rho gz_1 = p_2 + \\frac{1}{2}\\rho v_2^2 + \\rho gz_2$"
  },
  {
    id: "MecaFlu_09",
    q: "Interpr√©tation √©nerg√©tique du th√©or√®me de Bernoulli",
    a: "Conservation de l'√©nergie m√©canique par unit√© de volume : $p$ (√©nergie de pression) + $\\frac{1}{2}\\rho v^2$ (√©nergie cin√©tique) + $\\rho gz$ (√©nergie potentielle) = constante"
  },
  {
    id: "MecaFlu_10",
    q: "Formule de Torricelli pour la vidange d'un r√©servoir",
    a: "Vitesse d'√©coulement par un orifice √† la profondeur h : $v = \\sqrt{2gh}$"
  },
  {
    id: "MecaFlu_11",
    q: "D√©finition de la viscosit√© dynamique et cin√©matique",
    a: "Viscosit√© dynamique : $\\eta$ (Pa¬∑s). Viscosit√© cin√©matique : $\\nu = \\frac{\\eta}{\\rho}$ (m¬≤/s). Pour l'eau √† 20¬∞C : $\\eta \\approx 10^{-3}$ Pa¬∑s"
  },
  {
    id: "MecaFlu_12",
    q: "D√©finition du nombre de Reynolds et son interpr√©tation",
    a: "$Re = \\frac{\\rho v D}{\\eta} = \\frac{vD}{\\nu}$. Re < 2000 : laminaire. Re > 3000 : turbulent. Compare forces d'inertie et forces visqueuses."
  },
  {
    id: "MecaFlu_13",
    q: "Th√©or√®me de Bernoulli avec pertes de charge",
    a: "$p_1 + \\frac{1}{2}\\rho v_1^2 + \\rho gz_1 = p_2 + \\frac{1}{2}\\rho v_2^2 + \\rho gz_2 + \\Delta P$ o√π $\\Delta P$ repr√©sente l'√©nergie dissip√©e par frottement"
  },
  {
    id: "MecaFlu_14",
    q: "Loi de Poiseuille pour un √©coulement laminaire dans une conduite cylindrique",
    a: "$Q_v = \\frac{\\pi R^4 \\Delta P}{8 \\eta L}$ ou $\\Delta P = \\frac{8 \\eta L Q_v}{\\pi R^4}$. Les pertes sont proportionnelles au d√©bit et inversement proportionnelles √† $R^4$."
  },
  {
    id: "MecaFlu_15",
    q: "Profil de vitesse dans un √©coulement de Poiseuille",
    a: "Profil parabolique : $v(r) = v_{max}\\left(1 - \\frac{r^2}{R^2}\\right)$ avec $v_{max} = \\frac{\\Delta P \\cdot R^2}{4\\eta L}$"
  },
  {
    id: "MecaFlu_16",
    q: "Formule des pertes de charge lin√©aires",
    a: "$\\Delta P = \\lambda \\frac{L}{D} \\left(\\frac{1}{2}\\rho v^2\\right)$ o√π $\\lambda$ est le coefficient de perte de charge. Laminaire : $\\lambda = \\frac{64}{Re}$"
  },
  {
    id: "MecaFlu_17",
    q: "Formule des pertes de charge singuli√®res",
    a: "$\\Delta P_{singuli√®re} = K \\left(\\frac{1}{2}\\rho v^2\\right)$ o√π K est un coefficient sans dimension d√©pendant de la g√©om√©trie (coudes, vannes...)"
  },
  {
    id: "MecaFlu_18",
    q: "Formule de la force de tra√Æn√©e",
    a: "$F_{tra√Æn√©e} = \\frac{1}{2}\\rho S C_x v^2$ o√π S est la surface de r√©f√©rence (ma√Ætre-couple), $C_x$ le coefficient de tra√Æn√©e, v la vitesse relative"
  },
  {
    id: "MecaFlu_19",
    q: "Formule de la force de portance",
    a: "$F_{portance} = \\frac{1}{2}\\rho S C_z v^2$ o√π $C_z$ est le coefficient de portance. Force perpendiculaire √† la direction du mouvement."
  },
  {
    id: "MecaFlu_20",
    q: "Condition de flottaison d'un corps",
    a: "$\\vec{\\Pi} + \\vec{P} = \\vec{0}$ soit $\\rho_{corps} \\times V_{corps} = \\rho_{fluide} \\times V_{immerg√©}$. Le corps flotte si sa masse volumique moyenne est inf√©rieure √† celle du fluide."
  },
  {
    id: "MecaFlu_21",
    q: "Qu'est-ce qu'un fluide parfait ?",
    a: "Un fluide parfait est un fluide sans viscosit√© (pas de frottements internes). C'est une id√©alisation mais qui donne de bons r√©sultats pour de nombreux √©coulements."
  },
  {
    id: "MecaFlu_22",
    q: "Conditions d'application du th√©or√®me de Bernoulli",
    a: "1) √âcoulement permanent, 2) Fluide incompressible, 3) Fluide parfait (sans viscosit√©), 4) Le long d'une ligne de courant, 5) Champ de forces d√©rive d'un potentiel (pesanteur)"
  },
  {
    id: "MecaFlu_23",
    q: "Ordres de grandeur essentiels en m√©canique des fluides",
    a: "$\\rho_{eau} = 1000$ kg/m¬≥, $\\rho_{air} \\approx 1,3$ kg/m¬≥, $p_{atm} \\approx 10^5$ Pa, $\\eta_{eau}(20¬∞C) \\approx 10^{-3}$ Pa¬∑s, $g \\approx 10$ m/s¬≤"
  },
  {
    id: "MecaFlu_24",
    q: "Types d'√©coulement : d√©finitions",
    a: "Permanent : $\\frac{\\partial \\vec{v}}{\\partial t} = \\vec{0}$. Incompressible : $div(\\vec{v}) = 0$. Irrotationnel : $\\vec{rot}(\\vec{v}) = \\vec{0}$"
  }
];



/* =========================
   localStorage keys
   ========================= */
const LS_KEY_PROGRESS = "Meca-flu_flashcards_progress_v1";
const LS_KEY_ORDER = "Meca-flu_flashcards_order_v1";
const LS_KEY_FILTER = "Meca-flu_flashcards_filter_v1";

/* =========================
   State
   ========================= */
let baseCards = [...flashcardsData];
let cards = [];
let currentIndex = 0;
let isFlipped = false;

const cardElement = document.getElementById("cardElement");
const statusPill = document.getElementById("statusPill");
const filterSelect = document.getElementById("filterSelect");

/* =========================
   Progress storage
   progressMap[id] = "known" | "review" | null
   ========================= */
function loadProgress() {
    try {
        return JSON.parse(localStorage.getItem(LS_KEY_PROGRESS)) || {};
    } catch {
        return {};
    }
}

function saveProgress(progressMap) {
    localStorage.setItem(LS_KEY_PROGRESS, JSON.stringify(progressMap));
}

/* =========================
   Order storage (array of ids)
   ========================= */
function loadOrder() {
    try {
        return JSON.parse(localStorage.getItem(LS_KEY_ORDER)) || null;
    } catch {
        return null;
    }
}

function saveOrder(orderIds) {
    localStorage.setItem(LS_KEY_ORDER, JSON.stringify(orderIds));
}

/* =========================
   Filter storage
   ========================= */
function loadFilter() {
    return localStorage.getItem(LS_KEY_FILTER) || "all";
}

function saveFilter(value) {
    localStorage.setItem(LS_KEY_FILTER, value);
}

/* =========================
   Helpers
   ========================= */
function setStatusPill(state) {
    statusPill.classList.remove("status-known", "status-unknown", "status-unset");

    if (state === "known") {
        statusPill.classList.add("status-known");
        statusPill.textContent = "Ma√Ætris√©e";
    } else if (state === "review") {
        statusPill.classList.add("status-unknown");
        statusPill.textContent = "√Ä revoir";
    } else {
        statusPill.classList.add("status-unset");
        statusPill.textContent = "Non not√©e";
    }
}

function getCurrentCard() {
    return cards[currentIndex];
}

/* =========================
   Apply filter + order
   ========================= */
function rebuildCardsList(keepIndex = false) {
    const progressMap = loadProgress();
    const filter = filterSelect.value;

    // base list (ordered)
    const orderIds = loadOrder();
    let ordered = [...baseCards];

    if (Array.isArray(orderIds) && orderIds.length === baseCards.length) {
        const map = new Map(baseCards.map(c => [c.id, c]));
        ordered = orderIds.map(id => map.get(id)).filter(Boolean);
    }

    // filter
    if (filter === "known") {
        ordered = ordered.filter(c => progressMap[c.id] === "known");
    } else if (filter === "review") {
        ordered = ordered.filter(c => progressMap[c.id] !== "known");
    }

    // fallback if empty
    if (ordered.length === 0) {
        ordered = [...baseCards];
    }

    const oldId = keepIndex && cards[currentIndex] ? cards[currentIndex].id : null;

    cards = ordered;

    if (keepIndex && oldId) {
        const newIndex = cards.findIndex(c => c.id === oldId);
        currentIndex = newIndex >= 0 ? newIndex : 0;
    } else {
        currentIndex = 0;
    }

    updateCardContent();
}

/* =========================
   UI update
   ========================= */
function updateStats() {
    const progressMap = loadProgress();
    const total = baseCards.length;
    const known = baseCards.filter(c => progressMap[c.id] === "known").length;
    const review = total - known;
    const pct = total === 0 ? 0 : Math.round((known / total) * 100);

    const statsArea = document.getElementById("statsArea");
    statsArea.innerHTML = `
        <span class="chip">üü¢ Ma√Ætris√©es : <strong>${known}</strong> / ${total}</span>
        <span class="chip">üü† √Ä revoir : <strong>${review}</strong> / ${total}</span>
        <span class="chip">üìä ${pct}% ma√Ætris√©</span>
    `;
}

function updateCardContent() {
    if (!cards || cards.length === 0) return;

    const progressMap = loadProgress();
    const card = getCurrentCard();

    const qDiv = document.getElementById("questionContent");
    const aDiv = document.getElementById("answerContent");

    qDiv.innerHTML = card.q;
    aDiv.innerHTML = card.a;

    const status = progressMap[card.id] || null;
    setStatusPill(status);

    document.getElementById("currentCard").textContent = currentIndex + 1;
    document.getElementById("totalCards").textContent = cards.length;

    document.getElementById("progressFill").style.width =
        ((currentIndex + 1) / cards.length) * 100 + "%";

    updateStats();

    if (window.MathJax) {
        MathJax.typesetPromise([qDiv, aDiv]);
    }
}

/* =========================
   Actions
   ========================= */
function flipCard() {
    isFlipped = !isFlipped;
    cardElement.classList.toggle("is-flipped", isFlipped);
}

function nextCard(e) {
    if (e) e.stopPropagation();
    isFlipped = false;
    cardElement.classList.remove("is-flipped");

    setTimeout(() => {
        currentIndex = (currentIndex + 1) % cards.length;
        updateCardContent();
    }, 200);
}

function previousCard(e) {
    if (e) e.stopPropagation();
    isFlipped = false;
    cardElement.classList.remove("is-flipped");

    setTimeout(() => {
        currentIndex = (currentIndex - 1 + cards.length) % cards.length;
        updateCardContent();
    }, 200);
}

function shuffleCards() {
    isFlipped = false;
    cardElement.classList.remove("is-flipped");

    setTimeout(() => {
        // shuffle order IDs and store it
        const ids = [...baseCards.map(c => c.id)];
        ids.sort(() => Math.random() - 0.5);
        saveOrder(ids);

        rebuildCardsList(false);
    }, 250);
}

function resetOrder() {
    localStorage.removeItem(LS_KEY_ORDER);
    rebuildCardsList(false);
}

function resetProgress() {
    if (!confirm("Reset complet : tu veux supprimer toutes tes cartes ma√Ætris√©es/√† revoir ?")) return;
    localStorage.removeItem(LS_KEY_PROGRESS);
    rebuildCardsList(true);
}

function markKnow(e) {
    if (e) e.stopPropagation();

    const progressMap = loadProgress();
    const card = getCurrentCard();
    progressMap[card.id] = "known";
    saveProgress(progressMap);

    updateCardContent();
    // auto-next pour r√©vision rapide
    setTimeout(() => nextCard(), 150);
}

function markDontKnow(e) {
    if (e) e.stopPropagation();

    const progressMap = loadProgress();
    const card = getCurrentCard();
    progressMap[card.id] = "review";
    saveProgress(progressMap);

    updateCardContent();
    setTimeout(() => nextCard(), 150);
}

function applyFilter() {
    const val = filterSelect.value;
    saveFilter(val);
    rebuildCardsList(false);
}

/* =========================
   Keyboard shortcuts
   ========================= */
document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') nextCard();
    if (e.key === 'ArrowLeft') previousCard();

    if (e.key === ' ' || e.key === 'Enter') {
        e.preventDefault();
        flipCard();
    }

    // 1 = je sais pas / 2 = je sais
    if (e.key === '1') markDontKnow();
    if (e.key === '2') markKnow();
});

/* =========================
   Mobile swipe
   ========================= */
let touchStartX = 0;
const scene = document.querySelector('.card-scene');

scene.addEventListener('touchstart', e => {
    touchStartX = e.changedTouches[0].screenX;
});

scene.addEventListener('touchend', e => {
    let touchEndX = e.changedTouches[0].screenX;
    handleSwipe(touchStartX, touchEndX);
});

function handleSwipe(start, end) {
    const threshold = 50;
    if (start - end > threshold) nextCard();
    if (end - start > threshold) previousCard();
}

/* =========================
   Init
   ========================= */
(function init() {
    // restore filter
    const savedFilter = loadFilter();
    filterSelect.value = savedFilter;

    rebuildCardsList(false);
})();
</script></body>
</html> 
